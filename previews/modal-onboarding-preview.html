<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<style>
  @font-face {
    font-family: 'Inter';
    src: url('https://pikaso.cdnpk.net/public/media/Inter-Regular.woff2') format('woff2'),
         url('https://pikaso.cdnpk.net/public/media/Inter-Regular.woff') format('woff');
    font-weight: 400; font-style: normal; font-display: swap;
  }
  @font-face {
    font-family: 'Inter';
    src: url('https://pikaso.cdnpk.net/public/media/Inter-SemiBold.woff2') format('woff2'),
         url('https://pikaso.cdnpk.net/public/media/Inter-SemiBold.woff') format('woff');
    font-weight: 600; font-style: normal; font-display: swap;
  }

  :root {
    --modal-overlay: hsla(0, 0%, 0%, 0.5);
    --modal-radius: 24px;
    --modal-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
    --modal-font: 'Inter', 'Helvetica Neue', Helvetica, Arial, sans-serif;
    --modal-max-width: 860px;
    --modal-bg: hsl(0, 0%, 100%);
    --modal-title-color: hsl(0, 0%, 5%);
    --modal-text-color: hsl(0, 0%, 36%);
    --modal-cta-bg: hsl(0, 0%, 5%);
    --modal-cta-bg-hover: hsl(0, 0%, 26%);
    --modal-cta-bg-active: hsl(0, 0%, 36%);
    --modal-cta-color: hsl(0, 0%, 100%);
    --modal-border: rgba(13, 13, 13, 0.2);
    --modal-close-bg: hsla(0, 0%, 47%, 0.1);
    --modal-close-bg-hover: hsla(0, 0%, 47%, 0.15);
    --modal-close-color: hsl(0, 0%, 5%);
    --thumb-border-active: hsl(0, 0%, 5%);
    --thumb-border-inactive: transparent;
  }

  .dark {
    --modal-bg: hsl(0, 0%, 12%);
    --modal-title-color: hsl(0, 0%, 97%);
    --modal-text-color: hsl(0, 0%, 69%);
    --modal-cta-bg: hsl(0, 0%, 97%);
    --modal-cta-bg-hover: hsl(0, 0%, 90%);
    --modal-cta-bg-active: hsl(0, 0%, 85%);
    --modal-cta-color: hsl(0, 0%, 5%);
    --modal-border: hsla(0, 0%, 100%, 0.2);
    --modal-close-bg: hsla(0, 0%, 100%, 0.1);
    --modal-close-bg-hover: hsla(0, 0%, 100%, 0.15);
    --modal-close-color: hsl(0, 0%, 97%);
    --thumb-border-active: hsl(0, 0%, 97%);
    --thumb-border-inactive: transparent;
  }

  *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }
  body {
    font-family: var(--modal-font); font-size: 16px; line-height: 1.6;
    -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;
  }

  .braze-modal-overlay {
    position: fixed; inset: 0; display: flex; align-items: center; justify-content: center;
    background: var(--modal-overlay); z-index: 9999; padding: 48px 16px 16px;
    opacity: 0; animation: fadeIn 0.2s ease-out forwards;
  }

  .braze-modal-wrapper {
    position: relative; width: 100%; max-width: var(--modal-max-width);
    opacity: 0; transform: scale(0.95); filter: blur(12px);
    animation: scaleIn 0.35s cubic-bezier(0.16, 1, 0.3, 1) 0.05s forwards;
  }

  .braze-modal {
    position: relative; width: 100%; max-height: 90vh;
    background: var(--modal-bg); border-radius: var(--modal-radius);
    box-shadow: var(--modal-shadow); overflow: hidden;
    display: flex; flex-direction: row;
  }

  .braze-modal::after {
    content: ''; position: absolute; inset: 0;
    border-radius: var(--modal-radius);
    box-shadow: inset 0 0 0 1px var(--modal-border);
    pointer-events: none; z-index: 3;
  }

  .braze-modal__close {
    position: absolute; bottom: calc(100% + 8px); right: 0; z-index: 2;
    width: 32px; height: 32px; display: flex; align-items: center; justify-content: center;
    background: var(--modal-close-bg); border: none; border-radius: 9999px;
    cursor: pointer; transition: background 0.15s ease;
  }
  .braze-modal__close:hover { background: var(--modal-close-bg-hover); }
  .braze-modal__close svg { width: 14px; height: 14px; color: var(--modal-close-color); }

  .braze-modal__content {
    width: 45%; padding: 32px; display: flex; flex-direction: column;
    gap: 12px; overflow-y: auto; flex-shrink: 0;
  }

  .braze-modal__title { font-size: 1.25rem; font-weight: 600; line-height: 1.4; color: var(--modal-title-color); }
  .braze-modal__text { font-size: 0.875rem; font-weight: 400; line-height: 1.6; color: var(--modal-text-color); }

  .braze-modal__step-counter {
    font-size: 0.75rem; font-weight: 600; color: var(--modal-text-color);
    opacity: 0.6; text-transform: uppercase; letter-spacing: 0.05em;
  }

  .braze-modal__cta-wrapper {
    display: flex; justify-content: flex-end; margin-top: auto; padding-top: 8px; gap: 8px;
  }

  .braze-modal__cta {
    display: inline-flex; align-items: center; justify-content: center;
    height: 40px; padding: 0 16px; font-family: var(--modal-font);
    font-size: 0.875rem; font-weight: 600; line-height: 1;
    color: var(--modal-cta-color); background: var(--modal-cta-bg);
    border: none; border-radius: 8px; cursor: pointer; text-decoration: none;
    transition: background 0.15s ease-in-out; white-space: nowrap;
  }
  .braze-modal__cta:hover { background: var(--modal-cta-bg-hover); }
  .braze-modal__cta:active { background: var(--modal-cta-bg-active); }

  .braze-modal__carousel {
    flex: 1; display: flex; flex-direction: column; padding: 24px 24px 24px 0; gap: 16px;
  }

  .braze-modal__carousel-main {
    position: relative; aspect-ratio: 1 / 1; border-radius: 16px; overflow: hidden; background: hsl(0, 0%, 8%);
  }

  .braze-modal__carousel-main img {
    width: 100%; height: 100%; object-fit: cover; position: absolute; inset: 0;
    opacity: 0; transition: opacity 0.3s ease;
  }
  .braze-modal__carousel-main img.active { opacity: 1; }

  .braze-modal__carousel-thumbs { display: flex; gap: 8px; flex-shrink: 0; }

  .braze-modal__thumb {
    flex: 1; aspect-ratio: 1 / 1; border-radius: 8px; overflow: hidden; cursor: pointer;
    border: 1px solid transparent;
    transition: border-color 0.2s ease, opacity 0.2s ease;
    opacity: 0.5; padding: 0; background: none;
  }
  .braze-modal__thumb.active { border-color: var(--modal-border); opacity: 1; }
  .braze-modal__thumb:hover { opacity: 0.8; }
  .braze-modal__thumb.active:hover { opacity: 1; }
  .braze-modal__thumb img { width: 100%; height: 100%; object-fit: cover; display: block; }

  @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
  @keyframes scaleIn {
    from { opacity: 0; transform: scale(0.95); filter: blur(12px); }
    to { opacity: 1; transform: scale(1); filter: blur(0); }
  }
  @keyframes fadeOut { from { opacity: 1; } to { opacity: 0; } }
  @keyframes scaleOut {
    from { opacity: 1; transform: scale(1); filter: blur(0); }
    to { opacity: 0; transform: scale(0.95); filter: blur(12px); }
  }
  .braze-modal-overlay--closing { animation: fadeOut 0.15s ease-in forwards; }
  .braze-modal-overlay--closing .braze-modal-wrapper { animation: scaleOut 0.15s ease-in forwards; }

  /* Close button stays above the modal on all screen sizes */

  @media (max-width: 768px) {
    .braze-modal { flex-direction: column; max-height: 90vh; overflow-y: auto; }
    .braze-modal__carousel { order: -1; padding: 16px 16px 0; }
    .braze-modal-wrapper { max-width: 520px; }
    .braze-modal__content { width: 100%; padding: 24px; }
  }

  @media (max-width: 425px) {
    .braze-modal-wrapper { max-width: 100%; }
  }

  .preview-controls {
    position: fixed; top: 16px; right: 16px; z-index: 99999; display: flex; gap: 8px;
  }
  .preview-controls button {
    padding: 8px 16px; border: none; border-radius: 8px;
    font-family: var(--modal-font); font-size: 13px; font-weight: 600; cursor: pointer;
  }
  .preview-controls__light { background: #fff; color: #0d0d0d; box-shadow: 0 2px 6px rgba(0,0,0,.15); }
  .preview-controls__dark { background: #0d0d0d; color: #fff; }
</style>
</head>
<body>

  <div class="preview-controls">
    <button class="preview-controls__light" onclick="setTheme('light')">Light</button>
    <button class="preview-controls__dark" onclick="setTheme('dark')">Dark</button>
  </div>

  <div class="braze-modal-overlay" id="brazeModalOverlay">
    <div class="braze-modal-wrapper">

      <button class="braze-modal__close" id="brazeModalClose" aria-label="Close" type="button">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="4" y1="4" x2="12" y2="12" />
          <line x1="12" y1="4" x2="4" y2="12" />
        </svg>
      </button>

      <div class="braze-modal" role="dialog" aria-modal="true" aria-labelledby="brazeModalTitle">

        <div class="braze-modal__content">
          <span class="braze-modal__step-counter" id="brazeStepCounter">Step 1 of 6</span>
          <h2 class="braze-modal__title" id="brazeModalTitle">Step title</h2>
          <p class="braze-modal__text" id="brazeModalText">Step description</p>
          <div class="braze-modal__cta-wrapper">
            <a class="braze-modal__cta" id="brazeModalCta" href="#" role="button">Next</a>
          </div>
        </div>

        <div class="braze-modal__carousel">
          <div class="braze-modal__carousel-main" id="brazeCarouselMain"></div>
          <div class="braze-modal__carousel-thumbs" id="brazeCarouselThumbs"></div>
        </div>

      </div>
    </div>
  </div>

  <script>
    var brazeBridge = {
      logClick: function (id) { console.log('[Braze Preview] logClick', id || ''); },
      closeMessage: function () { console.log('[Braze Preview] closeMessage'); }
    };

    function setTheme(theme) {
      document.documentElement.classList.toggle('dark', theme === 'dark');
    }

    (function () {
      var STEPS = [
        {
          image: 'https://images.unsplash.com/photo-1618005182384-a83a8bd57fbe?w=800&h=600&fit=crop',
          title: 'Welcome to Pikaso Spaces',
          text: 'Organize all your AI creations in one place. Create, save, and share your work effortlessly with Spaces.',
          cta: 'Next'
        },
        {
          image: 'https://images.unsplash.com/photo-1614850523459-c2f4c699c52e?w=800&h=600&fit=crop',
          title: 'Create Collections',
          text: 'Group related images into collections. Keep your projects tidy and find what you need instantly.',
          cta: 'Next'
        },
        {
          image: 'https://images.unsplash.com/photo-1633412802994-5c058f151b66?w=800&h=600&fit=crop',
          title: 'Collaborate with Teams',
          text: 'Invite team members to your Spaces. Share feedback, iterate together, and ship faster.',
          cta: 'Next'
        },
        {
          image: 'https://images.unsplash.com/photo-1620641788421-7a1c342ea42e?w=800&h=600&fit=crop',
          title: 'AI-Powered Editing',
          text: 'Use our suite of AI tools to enhance, upscale, and transform your images directly in Spaces.',
          cta: 'Next'
        },
        {
          image: 'https://images.unsplash.com/photo-1579546929518-9e396f3cc809?w=800&h=600&fit=crop',
          title: 'Export & Download',
          text: 'Download in multiple formats and resolutions. Perfect for web, print, or social media.',
          cta: 'Next'
        },
        {
          image: 'https://images.unsplash.com/photo-1558591710-4b4a1ae0f04d?w=800&h=600&fit=crop',
          title: 'You\'re All Set!',
          text: 'Start exploring Spaces now. Your creative workspace is ready and waiting for you.',
          cta: 'Get Started',
          url: '/pikaso/spaces'
        }
      ];

      var currentStep = 0;
      var mainContainer = document.getElementById('brazeCarouselMain');
      var thumbContainer = document.getElementById('brazeCarouselThumbs');

      STEPS.forEach(function (step, i) {
        var img = document.createElement('img');
        img.src = step.image;
        img.alt = 'Step ' + (i + 1);
        img.loading = i === 0 ? 'eager' : 'lazy';
        if (i === 0) img.classList.add('active');
        mainContainer.appendChild(img);

        var thumb = document.createElement('button');
        thumb.className = 'braze-modal__thumb' + (i === 0 ? ' active' : '');
        thumb.setAttribute('aria-label', 'Go to step ' + (i + 1));
        thumb.setAttribute('type', 'button');
        var thumbImg = document.createElement('img');
        thumbImg.src = step.image;
        thumbImg.alt = '';
        thumb.appendChild(thumbImg);
        thumb.addEventListener('click', function () { goToStep(i); });
        thumbContainer.appendChild(thumb);
      });

      function goToStep(index) {
        if (index < 0 || index >= STEPS.length) return;
        currentStep = index;

        var mainImages = mainContainer.querySelectorAll('img');
        for (var i = 0; i < mainImages.length; i++) mainImages[i].classList.toggle('active', i === index);

        var thumbs = thumbContainer.querySelectorAll('.braze-modal__thumb');
        for (var j = 0; j < thumbs.length; j++) thumbs[j].classList.toggle('active', j === index);

        var step = STEPS[index];
        document.getElementById('brazeModalTitle').textContent = step.title;
        document.getElementById('brazeModalText').textContent = step.text;
        document.getElementById('brazeModalCta').textContent = step.cta;
        document.getElementById('brazeStepCounter').textContent = 'Step ' + (index + 1) + ' of ' + STEPS.length;
        if (step.url) document.getElementById('brazeModalCta').setAttribute('href', step.url);
      }

      goToStep(0);

      function closeModal() {
        var overlay = document.getElementById('brazeModalOverlay');
        if (!overlay) return;
        overlay.classList.add('braze-modal-overlay--closing');
        overlay.addEventListener('animationend', function () { brazeBridge.closeMessage(); });
        setTimeout(function () { brazeBridge.closeMessage(); }, 300);
      }

      document.getElementById('brazeModalClose').addEventListener('click', function (e) { e.preventDefault(); closeModal(); });

      document.getElementById('brazeModalOverlay').addEventListener('click', function (e) {
        if (e.target === this) closeModal();
      });

      document.getElementById('brazeModalCta').addEventListener('click', function (e) {
        e.preventDefault();
        if (currentStep < STEPS.length - 1) {
          goToStep(currentStep + 1);
        } else {
          console.log('[Braze Preview] Final CTA clicked, would navigate to:', this.getAttribute('href'));
          brazeBridge.logClick();
          closeModal();
        }
      });

      document.addEventListener('keydown', function (e) {
        if (e.key === 'Escape') closeModal();
        if (e.key === 'ArrowRight') goToStep(currentStep + 1);
        if (e.key === 'ArrowLeft') goToStep(currentStep - 1);
      });
    })();
  </script>
</body>
</html>
